<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Modify Customer Credit Note list and form -->
    <record id="credit_note_tree_usa" model="ir.ui.view">
        <field name="name">account.credit.note.tree.usa</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="invoice_tree_usa"/>
        <field name="mode">primary</field>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <field name="invoice_date" position="attributes">
                <attribute name="string">Credit Note Date</attribute>
            </field>
            <field name="amount_residual_signed" position="attributes">
                <attribute name="string">Balance</attribute>
            </field>

            <field name="invoice_date_due" position="replace">
            </field>
            <field name="aging_days" position="replace">
            </field>
            <field name="amount_untaxed_signed" position="replace">
            </field>
            <field name="amount_tax_signed" position="replace">
            </field>
        </field>
    </record>

    <record id="credit_note_form_usa" model="ir.ui.view">
        <field name="name">account.credit.note.form.usa</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="invoice_form_usa"/>
        <field name="mode">primary</field>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <field name="invoice_payment_term_id" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>

            <field name="invoice_date_due" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>

            <xpath expr="//notebook/page[1]" position="attributes">
                <attribute name="string">Line Items</attribute>
            </xpath>
            <xpath expr="//group[@id='header_right_group']/div[hasclass('o_td_label')]" position="replace">
                <label for="invoice_date" string="Credit Note Date" style="font-weight:bold;"
                                           attrs="{'invisible': [('type', '!=', 'out_refund')]}"/>
            </xpath>
            <xpath expr="//label[@for='invoice_payment_term_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//group[@id='header_right_group']/div[hasclass('d-flex')]/span" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>

    <record id="action_invoice_out_refund_tree" model="ir.actions.act_window.view">
        <field eval="1" name="sequence"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="credit_note_tree_usa"/>
        <field name="act_window_id" ref="account.action_move_out_refund_type"/>
    </record>

    <record id="action_invoice_out_refund_form" model="ir.actions.act_window.view">
        <field eval="2" name="sequence"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="credit_note_form_usa"/>
        <field name="act_window_id" ref="account.action_move_out_refund_type"/>
    </record>

    <!-- Modify Vendor Credit Note list and form -->
    <record id="credit_note_supplier_tree_usa" model="ir.ui.view">
        <field name="name">account.credit.note.supplier.tree.usa</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_invoice_tree"/>
        <field name="mode">primary</field>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <field name="invoice_date" position="attributes">
                <attribute name="string">Credit Note Date</attribute>
            </field>
            <field name="amount_residual_signed" position="attributes">
                <attribute name="string">Balance</attribute>
            </field>

            <field name="invoice_date_due" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>

    <record id="credit_note_supplier_form_usa" model="ir.ui.view">
        <field name="name">account.credit.note.supplier.form.usa</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="invoice_supplier_form_usa"/>
        <field name="mode">primary</field>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <button name="action_invoice_register_payment" position="attributes">
                <attribute name="string">Receive Refund</attribute>
            </button>

            <field name="invoice_payment_term_id" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="invoice_date_due" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <xpath expr="//notebook/page[1]" position="attributes">
                <attribute name="string">Line Items</attribute>
            </xpath>
            <xpath expr="//group[@id='header_right_group']/div[hasclass('o_td_label')]" position="replace">
                <label for="invoice_date" string="Credit Note Date" style="font-weight:bold;"
                                           attrs="{'invisible': [('type', '!=', 'in_refund')]}"/>
            </xpath>
            <xpath expr="//label[@for='invoice_payment_term_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//group[@id='header_right_group']/div[hasclass('d-flex')]/span" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>

    <record id="action_invoice_in_refund_tree" model="ir.actions.act_window.view">
        <field eval="1" name="sequence"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="credit_note_supplier_tree_usa"/>
        <field name="act_window_id" ref="account.action_move_in_refund_type"/>
    </record>

    <record id="action_invoice_in_refund_form" model="ir.actions.act_window.view">
        <field eval="2" name="sequence"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="credit_note_supplier_form_usa"/>
        <field name="act_window_id" ref="account.action_move_in_refund_type"/>
    </record>
</odoo>
