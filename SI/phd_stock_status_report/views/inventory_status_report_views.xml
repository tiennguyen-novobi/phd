<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <record id="view_inventory_status_report_form_view" model="ir.ui.view">
        <field name="name">view.stock.status.report.line.form.view</field>
        <field name="model">stock.status.report.line</field>
        <field name="arch" type="xml">
            <form create="0" import="0" delete="0" edit="0" >
                <sheet>
                    <group>
                        <group>
                            <field name="product_id" readonly="1"/>
                            <field name="qty_available"/>
                            <field name="free_qty"/>
                            <field name="qty_reserved"/>
                            <field name="safety_stock"/>
                            <field name="incoming_qty"/>
                            <field name="uom_id"/>
                        </group>
                        <group>
                            <field name="dynamical_forecasted_date" string="Forecasted Date" widget="limited_date" options="{'datepicker': {'startFromToday': True}}" />
                            <field name="forecasted_demand"/>
                            <field name="recommended_order_qty"/>
                            <field name="last_date_to_replenish"/>
                            <field name="stock_status"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Incoming Details">
                            <field name="purchase_line_ids">
                                <tree create="0" edit="0" order="date_planned, order_id asc">
                                    <field name="order_id" widget="many2one"/>
                                    <field name="date_planned"/>
                                    <field name="partner_id" string="Vendor"/>
                                    <field name="product_id"/>
                                    <field name="name"/>
                                    <field name="product_qty"/>
                                    <field name="qty_received"/>
                                    <field name="qty_invoiced"/>
                                    <field name="product_uom" string="UoM"/>
                                </tree>
                                <form string="Purchase Order Line">
                                        <field name="state" invisible="1"/>
                                        <field name="display_type" invisible="1"/>
                                        <field name="partner_id" invisible="1"/>
                                        <field name="company_id" invisible="1"/>
                                        <group attrs="{'invisible': [('display_type', '!=', False)]}">
                                            <group>
                                                <field name="product_uom_category_id" invisible="1"/>
                                                <field name="product_id" context="{'partner_id': partner_id}" widget="many2one_barcode" domain="[('purchase_ok', '=', True), '|', ('company_id', '=', False), ('company_id', '=', company_id)]"/>
                                                <label for="product_qty"/>
                                                <div class="o_row">
                                                    <field name="product_qty"/>
                                                    <field name="product_uom" groups="uom.group_uom" attrs="{'required': [('display_type', '=', False)]}"/>
                                                </div>
                                                <field name="qty_received_method" invisible="1"/>
                                                <field name="qty_received" string="Received Quantity" attrs="{'invisible': [('state', 'not in', ('purchase', 'done'))], 'readonly': [('qty_received_method', '!=', 'manual')]}"/>
                                                <field name="qty_invoiced" string="Billed Quantity" attrs="{'invisible': [('state', 'not in', ('purchase', 'done'))]}"/>
                                                <field name="price_unit"/>
                                                <field name="taxes_id" widget="many2many_tags" domain="[('type_tax_use', '=', 'purchase'), ('company_id', '=', company_id)]" options="{'no_create': True}"/>
                                            </group>
                                            <group>
                                                <field name="date_planned" widget="date" attrs="{'required': [('display_type', '=', False)]}"/>
                                                <field name="account_analytic_id" colspan="2" domain="['|', ('company_id', '=', False), ('company_id', '=', company_id)]" groups="analytic.group_analytic_accounting"/>
                                                <field name="analytic_tag_ids" groups="analytic.group_analytic_tags" domain="['|', ('company_id', '=', False), ('company_id', '=', company_id)]" widget="many2many_tags" options="{'color_field': 'color'}"/>
                                                <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                                            </group>
                                            <group colspan="12">
                                            <notebook>
                                                <page string="Notes">
                                                    <field name="name"/>
                                                </page>
                                                <page string="Invoices and Incoming Shipments">
                                                    <field name="invoice_lines"/>
                                                    <field name="move_ids"/>
                                                </page>
                                            </notebook>
                                            </group>
                                        </group>
                                        <label for="name" string="Section Name (eg. Products, Services)" attrs="{'invisible': [('display_type', '!=', 'line_section')]}"/>
                                        <label for="name" string="Note" attrs="{'invisible': [('display_type', '!=', 'line_note')]}"/>
                                        <field name="name" nolabel="1" attrs="{'invisible': [('display_type', '=', False)]}"/>
                                 </form>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_inventory_status_report_list_view" model="ir.ui.view">
        <field name="name">view.stock.status.report.line.list.view</field>
        <field name="model">stock.status.report.line</field>
        <field name="arch" type="xml">
            <tree string="Inventory Status Report" create="0" edit="0" import="0" delete="0" decoration-danger="stock_status == 'replenish'" >
                <field name="default_code"/>
                <field name="product_id" widget="many2one"/>
                <field name="qty_available"/>
                <field name="free_qty" optional="hide"/>
                <field name="qty_reserved" optional="hide"/>
                <field name="incoming_qty"/>
                <field name="dynamical_forecasted_date" string="Forecasted Date" widget="limited_date" options="{'datepicker': {'startFromToday': True, 'padding':'purchase_lead_time'}}" />
                <field name="forecasted_demand"/>
                <field name="recommended_order_qty"/>
                <field name="last_date_to_replenish"/>
                <field name="purchase_lead_time" invisible="1"/>
                <field name="stock_status"/>
                <button name="open_stock_status_record" type="object" string="" icon="fa-list" class="btn-secondary"/>
            </tree>
        </field>
    </record>

    <record id="view_inventory_status_report_search_view" model="ir.ui.view">
        <field name="model">stock.status.report.line</field>
        <field name="arch" type="xml">
            <search string="Inventory Status Report Search">
                <field name="product_id" string="Product"/>
                <separator/>
                <filter string="Enough" name="stock_status_enough" domain="[('stock_status', '=', 'enough')]"/>
                <filter string="Replenish" name="stock_status_replenish" domain="[('stock_status', '=', 'replenish')]"/>
            </search>
        </field>
    </record>

    <record id="action_inventory_status_report_views" model="ir.actions.act_window">
        <field name="name">Inventory Status Report</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">stock.status.report.line</field>
        <field name="view_mode">tree</field>
        <field name="search_view_id" ref="view_inventory_status_report_search_view"/>
        <field name="view_ids"
               eval="[(5, 0, 0),
                      (0, 0, {'view_mode': 'tree', 'view_id': ref('view_inventory_status_report_list_view')})]"/>
        <field name="view_id" ref="view_inventory_status_report_list_view"/>
        <field name="domain">[('forecasted_demand_ok','=',True)]</field>
    </record>


    <menuitem id="menu_inventory_status_report"
              name="Inventory Status Report"
              parent="stock.menu_warehouse_report"
              sequence="109"
              action="action_inventory_status_report_views"
              groups="phd_inventory.group_stock_view_only"
    />

</odoo>